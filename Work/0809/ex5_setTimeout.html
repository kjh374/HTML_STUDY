<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body onload="init()">
    <form>
        <fieldset>
            <legend>Progress연습</legend>
            
            <label for="s1">Progress:</label>
            <progress value="0.05" max="1" id="s1" name="s1">
                브라우저가 progress를 지원하지 않습니다.
            </progress>    
            <span>5</span>% <!-- 앞서 배운 output으로 해도 좋은 방법이다.  -->

            <button type="submit">보내기</button>
        </fieldset>
    </form>

    <script>
        let inter = null; // 인터벌 객체를 저장할 변수
        // 인터벌 객체란 지정한 시간만큼 간격을 두고 지정한 함수를 "단 한번" 호출한다.

        function init(){
            // 0.5초 간격으로 pGo()라는 함수를 딱! 한번 호출하는 인터벌객체 생성!
            inter = setTimeout("pGo()", 500); // setTimeout("function()", 1000*second);

        }

        function pGo(){
            console.log("^^");
            // 현재문서에서 아이디가 s1인 요소를 검색하여 검색된 s1의 값(value)을 일정한 값으로 증가시켜야 한다.

            // 1) s1이라는 아이디를 가진 요소를 검색한다.
            let pp = document.getElementById("s1");

            // 2) 현재문서안에 폼 안에 fieldset 안에 span요소를 검색한다.
            let pspan = document.querySelector("form fieldset span"); // querySelector("CSS선택자") : 
            // 위를 검색한 이유는 s1의 값을 span요소에도 동일하게 문자열로 표현하기 위함이다.

            // 3) s1의 값을 조금 증가시킨다.
            pp.value = pp.value + 0.05; // 프로그레스바의 값을 증가시켰다.
            
            // 4) 2)에서 검색된 span태그의 문자열을 pp의 값으로 변경한다.
            pspan.innerText = parseInt(pp.value*100); // parseInt() : 정수화한다. 
            
            // 프로그레스바의 값이 1이면 진행완료이므로 움직이고 있던 인터벌 객체를 소멸시켜야 한다.
            if(pp.value>= 1  ){ // s1의 max==1 이므로 1을 넘어가면 인식하지 않는다.
                // 인터벌 객체를 소멸시킨다.!!!!!!
                clearInterval(inter); 
                alert("완료!");
            }

            // setTimeout("pGo()", 500); // 좋은 예는 아니다. ( 하지마 )
        }
    </script>
</body>
</html>